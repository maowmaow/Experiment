<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
{% load staticfiles %}
<title>Stock trading game - Client portfolio</title>
<link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet" media="all" />

<script src="{% static 'js/jquery-2.1.0.min.js' %}"></script>
<script src="{% static 'js/angular.min.js' %}"></script>
<script src="{% static 'js/angular-cookies.min.js' %}"></script>
<script src="{% static 'js/angular-resource.min.js' %}"></script>
<script src="{% static 'stock/js/app-stock.js' %}"></script>
</head>
<body ng-app="stockApp">
<section class="container" ng-controller="stockClientController">
	<h1>Portfolio: {{portfolio.name}}</h1>
	{% verbatim %}
	<div class="row">
		<div class="col-md-6">
			<form role="form" class="form">
				<div class="panel panel-default">
					<div class="panel-heading">
						<p class="pull-right">Current Cash: {{cash|currency}}</p>
						<h3 class="panel-title">Place your order</h3>
					</div>
						<table class="table" style="margin-bottom:0">
							<thead>
								<tr><th>Stock</th><th>Price</th><th>Quantity</th><th></th></tr>
							</thead>
							<tbody>
								<tr>
									<td><div class="form-group">
											<input name="stock" placeholder="Stock" class="form-control" style="width:100px" />
											<div class="radio"><label><input type="radio" checked /> Buy</label></div>
											<div class="radio"><label><input type="radio" /> Sell</label></div>
										</div>
									</td>
									<td><div class="form-group">
											<input name="price" placeholder="Price" type="number" class="form-control" style="width:100px" />
											<div class="radio"><label><input type="radio" checked /> Limit</label></div>
											<div class="radio"><label><input type="radio" /> Market Price</label></div>
										</div>
									</td>
									<td><input name="qty" placeholder="QTY" type="number" class="form-control" style="width:100px" /></td>
									<td><button class="btn btn-default">Submit</button></td>
								</tr>
							</tbody>
						</table>
				</div>
			</form>
			
			<div class="panel panel-default">
				<div class="panel-heading">
					<h3 class="panel-title">Order history</h3>
				</div>
				<div class="panel-body">
					<table class="table">
						<thead>
							<tr>
								<th>#</th>
								<th>Time</th>
								<th>Stock</th>
								<th>Price</th>
								<th>QTY</th>
								<th>Status</th>
							</tr>
						</thead>
					</table>
				</div>
			</div>
		</div>
		<div class="col-md-6">
			<table class="table">
				<thead>
					<tr>
						<th>Stock</th>
						<th>Avg. Price</th>
						<th>QTY</th>
					</tr>
				</thead>
				<tbody>
					<tr ng-repeat="d in details_list">
						<td>{{d.stock}}</td>
						<td>{{d.price}}</td>
						<td>{{d.qty}}</td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>
	{% endverbatim %}
</section>
<footer>
	
</footer>
<script>
stockApp.controller('stockClientController', ['$scope', '$http', '$window', '$interval', 'clientSvc', function($scope, $http, $window, $interval, clientSvc) {

	$scope.poll_rate = 2000;
	
	$scope.loadData = function() {
		clientSvc.get(null, function(value) {
			$scope.cash = value.cash;
			$scope.order_list = value.order;
			$scope.details_list = value.details;
		});
	}
	
	$interval(function() { $scope.loadData(); }, $scope.poll_rate);
}]);
</script>
</body>
</html>