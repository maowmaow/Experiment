<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
{% load staticfiles %}
<title>Ultimatum game</title>
<link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet" media="all" />

<script src="{% static 'js/jquery-2.1.0.min.js' %}"></script>
<script src="{% static 'js/angular.min.js' %}"></script>
<script src="{% static 'js/angular-cookies.min.js' %}"></script>
<script src="{% static 'js/angular-resource.min.js' %}"></script>
<script src="{% static 'ultimatum/js/app-ultimatum.js' %}"></script>
</head>
<body ng-app="ultimatumApp">
<header>
	{% csrf_token %}
</header>
{% verbatim %}
<section class="container" ng-controller="utAdminController">
	<h1>Create Room</h1>
	<form class="form-horizontal" role="form" ng-submit="createRoom()">
		<div class="form-group">
			<label class="col-sm-2 control-label">Room Name</label>
			<div class="col-sm-10"><input type="text" class="form-control" ng-model="name" /></div>
		</div>
		<div class="form-group">
			<div class="col-sm-offset-2 col-sm-10">
				<button type="submit" class="btn btn-default">Create</button>
			</div>
		</div>
	</form>
	
	<div class="list-group">
		<a href="javascript:void(0)" class="list-group-item" ng-repeat="r in room_list" ng-cloak>
			<h4 class="list-group-item-heading">{{r.name}} <button type="button" class="btn btn-default btn-xs" ng-click="deleteRoom(r)">Delete</button></h4>
		</a>
	</div>
</section>
{% endverbatim %}
<footer>
	
</footer>
<script>
ultimatumApp.controller('utAdminController', ['$scope', '$http', 'roomSvc', function($scope, $http, roomSvc) {
	$scope.loadRoom = function(pageNo) {
		$scope.room_list = roomSvc.query();
	};

	$scope.createRoom = function() {
		roomSvc.save({}, { name: $scope.name }, function() {
			$scope.loadRoom();
		});
	};
	
	$scope.deleteRoom = function(room) {
		roomSvc.delete({ room_pk:room.pk }, null, function(value, headers) {
			$scope.loadRoom();
		});
	};
	
	$scope.loadRoom();
	
}]);
</script>
</body>
</html>